# Bigquery_snowflake_integration_dbt_Chicago_taxi_trips


Задача на использование dbt, разработана Chatgpt:


Найдите три машины, получившие наибольшее количество чаевых в апреле 2018 года, и выведите, как изменялась эта сумма в процентах в последующие месяцы по сравнению с предыдущим в таблице со столбцами taxi_id, year_month, tips_sum, tips_change. В качестве даты поездки возьмите дату начала поездки.

В качестве источника данных используйте bigquery-public-data.chicago_taxi_trips. 
Дополнительным плюсом будет, если вы определите источники, разнесёте cte по разным моделям, опишете столбцы моделей и сделаете финальную таблицу инкрементальной.
Результат необходимо представить в виде таблицы google sheets и публичного репозитория GitHub.


При выполнении задания было принято решение рассматривать поставленную задачу как ad-hoc. Для работы с BigQuery необходимо было разбираться с новым для меня коннектором, а коннектор Snowflake был уже настроен. Поэтому было принято решение прописать интеграцию snowflake-google cloud storage и использовать в качестве DWH для указанного в задании датасета snowflake. Файл с sql-кодом интеграции представлен в репозитории. Далее были созданы 5 моделей dbt с разными материализациями (view, table, incremented table). Прописаны source и warning по freshness. Результирующая табличка сделана инкрементальной и отдельно выгружена в googlesheets. На данном этапе описание полей сделать не получилось так как dbt power user требует бизнесовое мыло.  


https://docs.google.com/spreadsheets/d/1q4SH5DBEGI1xP5D3d5AO_tprh67Kwi4XJe8rr8mq2j4/edit?usp=sharing - итоговый результат в google sheets

